# @package _global_

defaults:
  - option_retriever
  - override /datamodule/dataset_transform: flatten
  - override /datamodule/sampler: supervised
  - override /model/module/reader_head: none
  - override /model/module/gradients: supervised
  - override /callbacks:
      - checkpoint
      - lr_monitor
      - progress_bar


trainer:
  max_steps: 10_000
  val_check_interval: 0.5

base:
  target_metric: validation/retriever/Accuracy
  device_batch_size: 4
  eval_device_batch_size: 16

model:
  num_warmup_steps: 1_000
  num_training_steps: 50_000
  optimizer_params:
    lr: 1e-5
  module:
    share_documents_across_batch: true

datamodule:
  dataset_update: null
  dset_name: medqa-us+medqa-tw
  corpus_name: medwiki+medqa

  # dataloader
  drop_last: true # required with `share_documents_across_batch`


logger:
  wandb:
    group: supervised
